%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer Presentation
% LaTeX Template
% Version 1.0 (10/11/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------

\documentclass{beamer}

\mode<presentation> {

% The Beamer class comes with a number of default slide themes
% which change the colors and layouts of slides. Below this is a list
% of all the themes, uncomment each in turn to see what they look like.

%\usetheme{default}
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
%\usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{Dresden}
%\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
%\usetheme{Ilmenau}
%\usetheme{JuanLesPins}
%\usetheme{Luebeck}
\usetheme{Madrid}
%\usetheme{Malmoe}
%\usetheme{Marburg}
%\usetheme{Montpellier}
%\usetheme{PaloAlto}
%\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Singapore}
%\usetheme{Szeged}
%\usetheme{Warsaw}

% As well as themes, the Beamer class has a number of color themes
% for any slide theme. Uncomment each of these in turn to see how it
% changes the colors of your current slide theme.

%\usecolortheme{albatross}
%\usecolortheme{beaver}
%\usecolortheme{beetle}
%\usecolortheme{crane}
%\usecolortheme{dolphin}
%\usecolortheme{dove}
%\usecolortheme{fly}
%\usecolortheme{lily}
%\usecolortheme{orchid}
%\usecolortheme{rose}
%\usecolortheme{seagull}
%\usecolortheme{seahorse}
%\usecolortheme{whale}
%\usecolortheme{wolverine}

\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
%\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line

  
\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}

\logo{%
  \makebox[0.99\paperwidth]{%
  	%\includegraphics[width=1cm,keepaspectratio]{intercrossing.png}%
  	\hfill%
    %\includegraphics[width=1cm,keepaspectratio]{intercrossing.png}%
    %\hfill%
    
    \includegraphics[width=2.5cm,keepaspectratio]{era7.png}%
    \vspace{1cm}
    
  }%
}

\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title[MG7]{MG7: A fast horizontally scalable tool based on
cloud computing and graph databases for
microbial community profiling
} % The short title appears at the bottom of every slide, the full title is only on the title page


%Metapasta is a version of MG7 written in Scala programing language that designed to be process big amount of data.



\author{Evdokim~Kovach, Alexey~Alekhin, Marina~Manrique, Pablo~Pareja-Tobes, Eduardo~Pareja, Raquel~Tobes and Eduardo~Pareja-Tobes} % Your name
\institute[Era7] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
Oh no sequences! Research Group, Era7 bioinformatics
 \\ % Your institution for the title page
%\medskip
Granada, Spain
%\textit{eparejatobes@ohnosequences.com} % Your email address
}

%\author{Partner student: Alexandra Vatsiou}
\date{April 8, 2014} % Date, can be changed to a custom date

\begin{document}

\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

% \begin{frame}
% \frametitle{Overview} % Table of contents slide, comment this block out to remove it
% \tableofcontents % Throughout your presentation, if you choose to use \section{} and \subsection{} commands, these will automatically be printed on this slide as an overview of your presentation
% \end{frame}

%----------------------------------------------------------------------------------------
%	PRESENTATION SLIDES
%----------------------------------------------------------------------------------------



\begin{frame}
\frametitle{What is metagenomics?}

Metagenomics is the the study about collecting of genetic material from mixed community of organisms (usually bacteria):
\begin{itemize}
  \item Soil samples
  \item Marine samples
  \item Clinical samples.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{The problem of metagenomics}


The typical problem of metagenomics is to obtain information about species composition in the sample:
\begin{itemize}
  \item Which species are presented in the sample?
  \item How many different species are presented in the sample? 
  \item How many species from the given genus are presented in the sample?
\end{itemize}

\end{frame}


\begin{frame}
\frametitle{16S databases}
16S rRNA gene is widely used to identify bacteria. There are several publicly available databases:

\begin{itemize}
  \item NCBI 16S
  \item Greengenes
  \item SILVA.
\end{itemize}


\end{frame}

\begin{frame}
\frametitle{What is MG7?}

MG7 is a cloud tool that performs assignment to the taxonomy tree based on mapping of reads from samples
against 16S database.

\vspace{1em}


Metapasta is a version of MG7 written in Scala that designed to process a really big amounts of metagenomics data.


\end{frame}

\begin{frame}
\frametitle{Input}
\begin{itemize}
  \item Sequenced metagenomics samples -- reads in FASTQ format
  \item Taxonomy database (we are using NCBI taxonomy database that is integrated to Bio4j)
  \item 16S database (by default Metapasta uses NCBI 16S with some filtering).
\end{itemize}
\end{frame}


\begin{frame}
\frametitle{Output}
As result Metapasta produces
\begin{itemize}
  \item For every taxonomy id and sample: 
  \begin{itemize}
  	\item number of reads from the sample that were assigned to this tax id
  	\item number of reads from the sample that were assigned to all successors of this tax id
  \end{itemize} 
  \item Aggregated data by samples. 
\end{itemize}
\end{frame}


\begin{frame}
\frametitle{Results. Trees}
\includegraphics[width=0.9\textwidth]{tree.pdf}
\end{frame}


\begin{frame}
\frametitle{Results. Tables}
\includegraphics[width=\textwidth]{table.pdf}
\end{frame}



\begin{frame}
\frametitle{Metapasta pipeline}
\includegraphics[width=\textwidth]{general.pdf}

\begin{itemize}
  \item (optional) FLASh merging paired-end reads into bigger reads
  \item Mapping reads against the 16S database (with BLAST or LAST)
  \item Assignment to the taxonomy tree using Bio4j.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Mapping problem}
Mapping NGS reads against the 16S database requires really a lot of computational resources.
\\
For example even on fast computers with SSD and big size of RAM mapping of one read with BLAST takes more than 0.2 seconds.

$$ 1 000 000 \times 0.2 s \approx 56 h $$

The mapping time can be improved by using a more efficient mapping tool (by default Metapasta uses LAST that in 100 times faster than BLAST in this case).
\end{frame}

\begin{frame}
\frametitle{Cloud solution}

Metapasta uses AWS (Amazon Web Services) to perform all computations (EC2 instances):

\includegraphics[width=\textwidth]{pipeline_dist.pdf}
\end{frame}



\begin{frame}
\frametitle{Cloud solution. Data management}
Besides computations Metapasta uses AWS for all data management:
\begin{itemize}
  \item Reads from samples (S3)
  \item Taxonomy assignment tables and trees in PDF (S3)
  \item Metapasta can upload all reads (with assignments) to DynamoDB table.
\end{itemize}
\end{frame}



\begin{frame}
\frametitle{Nispero}
\includegraphics[width=0.7\textwidth]{nispero.png}
\begin{itemize}
  \item Scala library for building distributed using AWS
  \item Easy to use (only AWS account is needed)
  \item Scalable and robust.
  % \item Designed to provide maximal level of scalability and availability 
  % (in case of Metapasta it means that it can process {\bf with a good performance} as many data as needed, and never will lose any of reads).
\end{itemize}
\end{frame}


\begin{frame}
\frametitle{Nispero. Architecture}
\hspace{0.05\textwidth}
\includegraphics[width=0.9\textwidth]{architecture.pdf}
\hspace{0.05\textwidth}

\end{frame}

% \begin{frame}
% \frametitle{Nispero}

% \begin{itemize}
%   \item Amazon auto scaling groups
%   \item SQS queues
% \end{itemize}
% \end{frame}

\begin{frame}
\frametitle{Monoids}

We are using idempotent commutative monoids to describe distributed	systems in Nispero.


$$ Reads \otimes Reads \xrightarrow{merge} Reads \xrightarrow{BLAST} AssignTable \otimes Reads $$

\begin{itemize}
  \item They are powerful enough to build complex systems
  \item It is easy to work with them abstractly (for example to create graphical workflow editor that produces distributed systems).
\end{itemize}

\end{frame}

%lastvizmeta010-snapshot
% \begin{frame}
% \frametitle{Bio4j}

% \begin{columns}[T]
% 		\begin{column}{.5\textwidth}
% 			\includegraphics[width=\textwidth]{bio4j.png}
% 		\end{column}
% 		\begin{column}{.5\textwidth}
% 			NCBI taxonomy
% 		\end{column}
% 	\end{columns}
% \end{frame}



\begin{frame}
\frametitle{Nispero}
\hspace{0.2\textwidth}
\includegraphics[width=0.6\textwidth]{nispero.jpg}
\hspace{0.2\textwidth}
\\
Do not lose opportunity to try this amazing Spanish fruit!
\end{frame}




% \begin{frame}
% \frametitle{INTERCROSSING}
% This project is funded in part by the ITN FP7 project INTERCROSSING (Grant 289974).

% \begin{columns}[T]
% 		\begin{column}{.5\textwidth}
% 			\hspace{.25\textwidth}\includegraphics[width=.5\textwidth]{intercrossing.png}
% 		\end{column}
% 		\begin{column}{.5\textwidth}
% 			\hspace{.25\textwidth}\includegraphics[width=.5\textwidth]{mc.jpg}
% 		\end{column}
% 	\end{columns}
% \end{frame}


\begin{frame}
\Huge{\centerline{Thank you for your attention!}}
\end{frame}
\end{document}